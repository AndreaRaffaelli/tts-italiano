#!/usr/bin/env python3
"""
Test script to verify the preprocessing environment setup.
"""
import sys
import torch
import transformers
import datasets
import soundfile
import numpy as np
from multiprocessing import cpu_count

def test_environment():
    print("🧪 Testing SpeechT5 Preprocessing Environment")
    print("=" * 50)
    
    # Python version
    print(f"🐍 Python: {sys.version}")
    
    # PyTorch (CPU)
    print(f"🔥 PyTorch: {torch.__version__}")
    print(f"🖥️  Device: {'GPU available' if torch.cuda.is_available() else 'CPU only'}")
    
    # Key libraries
    print(f"🤗 Transformers: {transformers.__version__}")
    print(f"📊 Datasets: {datasets.__version__}")
    
    # System resources
    print(f"⚙️  CPU cores: {cpu_count()}")
    
    # Test basic functionality
    print("\n🔬 Testing basic functionality:")
    
    # Test tensor operations
    x = torch.randn(100, 100)
    y = torch.mm(x, x.T)
    print(f"✅ PyTorch tensor operations: {y.shape}")
    
    # Test audio processing
    try:
        import librosa
        print(f"✅ Librosa available: {librosa.__version__}")
    except ImportError:
        print("⚠️  Librosa not available")
    
    # Test datasets
    try:
        from datasets import load_dataset
        print("✅ Datasets loading capability: OK")
    except Exception as e:
        print(f"⚠️  Datasets issue: {e}")
    
    print("\n✨ Environment test completed!")

if __name__ == "__main__":
    test_environment()