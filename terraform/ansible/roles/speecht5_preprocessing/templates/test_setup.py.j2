#!/usr/bin/env python3
"""
Test script to verify the preprocessing environment setup.
"""
import sys
import torch
import transformers
import datasets
import soundfile
import numpy as np
from multiprocessing import cpu_count

def test_environment():
    print("ğŸ§ª Testing SpeechT5 Preprocessing Environment")
    print("=" * 50)
    
    # Python version
    print(f"ğŸ Python: {sys.version}")
    
    # PyTorch (CPU)
    print(f"ğŸ”¥ PyTorch: {torch.__version__}")
    print(f"ğŸ–¥ï¸  Device: {'GPU available' if torch.cuda.is_available() else 'CPU only'}")
    
    # Key libraries
    print(f"ğŸ¤— Transformers: {transformers.__version__}")
    print(f"ğŸ“Š Datasets: {datasets.__version__}")
    
    # System resources
    print(f"âš™ï¸  CPU cores: {cpu_count()}")
    
    # Test basic functionality
    print("\nğŸ”¬ Testing basic functionality:")
    
    # Test tensor operations
    x = torch.randn(100, 100)
    y = torch.mm(x, x.T)
    print(f"âœ… PyTorch tensor operations: {y.shape}")
    
    # Test audio processing
    try:
        import librosa
        print(f"âœ… Librosa available: {librosa.__version__}")
    except ImportError:
        print("âš ï¸  Librosa not available")
    
    # Test datasets
    try:
        from datasets import load_dataset
        print("âœ… Datasets loading capability: OK")
    except Exception as e:
        print(f"âš ï¸  Datasets issue: {e}")
    
    print("\nâœ¨ Environment test completed!")

if __name__ == "__main__":
    test_environment()